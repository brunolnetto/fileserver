{% extends 'web/base.html' %}

{% block title %}Home{% endblock %}

{% block content %}
<div class="container">
    <h1>Welcome to My Django App</h1>
    
    {% if user.is_authenticated %}
        {% if user.userprofile.first_login %}
            <p>Hello, {{ user.username }}! Welcome to your first visit to the app.</p>
            <script>
                document.addEventListener('DOMContentLoaded', function() {
                    fetch("{% url 'update_first_login_flag' %}", {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': '{{ csrf_token }}'
                        },
                        body: JSON.stringify({})
                    });
                });
            </script>
        {% else %}
            <p>Welcome back, {{ user.username }}!</p>
        {% endif %}
        <p>Use the links in the sidebar to navigate to different sections of the app.</p>
    {% else %}
        <p>Please sign up or log in using the sidebar buttons above to access the app.</p>
    {% endif %}
</div>
{% endblock %}
